<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Reproducible Research: Peer Assessment 1</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<hr/>

<h1>Reproducible Research: Peer Assessment 1</h1>

<h2>Loading and preprocessing the data</h2>

<pre><code class="r">require(&quot;ggplot2&quot;)
require(&quot;plyr&quot;)

## unzip an load the data
unzip(&quot;activity.zip&quot;)
activity  &lt;- read.csv(&quot;activity.csv&quot;, header = TRUE, sep = &quot;,&quot;)
file.remove(&quot;activity.csv&quot;)
</code></pre>

<h2>What is mean total number of steps taken per day?</h2>

<pre><code class="r">## total number of steps taken per day
dailysteps &lt;- ddply(activity, .(date), summarise, 
                total_steps = sum(steps, na.rm = TRUE))
</code></pre>

<pre><code class="r">## mean and median
mean_step = round(mean(dailysteps$total_steps))
median_step = median(dailysteps$total_steps)

## make a vector and a frame for the mean and the median line
ve &lt;- c(mean_step, median_step)
df &lt;- data.frame(ve)
</code></pre>

<pre><code class="r">## histogram of the total number of steps taken each day
histo &lt;- ggplot(dailysteps, aes(x= total_steps)) +
          geom_histogram(fill=&quot;lightblue&quot;, colour=&quot;black&quot;, binwidth=2000) +
          geom_vline(data=df, aes(xintercept=ve), colour=factor(ve),
                     linetype=&quot;dashed&quot;, size=1, show_guide = TRUE)+
          xlab(&quot;Total Number of steps&quot;) +
          ggtitle(&quot;The total number of steps taken each day&quot;)
histo
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA2AAAAGwCAMAAAD47faQAAAAGFBMVEUAAAAAzQB/f3+t2Obl5eXy8vL/AAD///+UmabBAAAACXBIWXMAAAsSAAALEgHS3X78AAASk0lEQVR4nO2di3aryLIE2Zo7W///x/cYyzIgElUWdKtgItbyY8sUnarqMLaY4zPcAaAZw6cDAFwZBANoCIIBNATBABqCYAANQTCAhiAYQEMQDKAhCAbQEAQDaAiCATQEwQAagmAADUEwgIYgGEBDEAygIQgG0BAEA2gIguUZvllv4hD4XJw2sLBxvLf42zBsGA/6tYth8n7tK9ufb50zfgCCVYZ+7eJHsOH7ojIMPxeXx6Xt5f1Pw39KhsdZvv79fGh+tuG+dtLHv1/O/lu7UvNcbXH0NPswO8PykPEU0+s2G2gb+rOLxyZ7bN7h96H73J755yslw8/b+pd+F5v8RDqsnH352GqQ5dEvJ58cujzT7yEIFoH+7GKyyd4Idp9/Lvbz8qFl9YtgaytNa14WXzt6enKRUx3C/nkDDdrFQrBh8uPbfbndZy+IRARbvoTyatzz+jI7dnh+aRLx8eXhvnb05DGRc/757yHsnzfQoF2sXMEmX3m5UvhXsPvkrGKZ6T5/8WGx+PDuaJVzeabHG9vnHXRoF3HBFsf0FWyxypZgIudaZgQLQId2sSKY3td38SPi9Met78vMqmir5i31XT72uvjyzNuBXp7S5BAEC0CHdjEXbPIK+vQl9Ofna1eGycPPPb18mf7+e87ZA/OzP7b84mX618WH+YmG+cmnr8WvHDLNzO4JQIsuRedxsnveQosuBYJVgxZdiq7jHNg873F69H/r/Cse91Bn9zgmywfD/P378tBvmD9/+oZZgTEpfsIgWAAEUzAmBYIZIJiCMSkQzADBFIxJgWAGCKZgTAoEM0AwBWNSIJgBgikYkwLBDBBMwZgUCGZAGAVhFAhmQBgFYRQIZkAYBWEUCGZAGAVhFAhmQBgFYRQIZkAYBWEUCGZAGAVhFAhmQBgFYRQIZlDqRvPw5M+fwWF3mBUYkwLBDGoJ9s8Pf/78Y4BgMRDM4PSTQzCDkmEQLACCKRiTAsEMEEzBmBQIZoBgCsakQDADBFMwJgWCGSCYgjEpEMygVJjhvUsItgMEM7ji5BBMUTIMggUoFQbBFCXDIFiAUmEQTFEyDIIFKBUGwRQlwyBYgFJhEExRMgyCBSgVBsEUJcMgWIBSYRBMUTIMggXgRrOCMSkQzADBFIxJgWAGCKZgTIqEYLevt/+BYDkQTHHlMHHBRrNukweaBizZrH0gmOLKYcKC3b7kel7AplcyaMffvy8PpQX7QHxY8uZHxNlFrOl3gJLfjfbBFUxx5TCeYJMPCOaCYIorh+EKFqBUGG40K0qGMa9g01+9mgYs2ax9IJjiymEMwZY0DViyWftAMMWVwyBYgFJhEExRMgyCBSgVBsEUJcMgWIBSYRBMUTIMggUoFQbBFCXDIFiAUmEQTFEyDIIF4EazgjEpEMwAwRSMSYFgBgimYEwKBDNAMAVjUiCYAYIpGJMCwQwQTMGYFAhmgGAKxqRAMAMEUzAmBYIZlArDjWZFyTAIFqBUGARTlAyDYAFKhUEwRckwCBagVBgEU5QMg2ABSoVBMEXJMAgWoFQYBFOUDINgAUqFQTBFyTAIFqBUGARTlAyDYAG40axgTAoEM0AwBWNSIJgBgikYkwLBDBBMwZgUCGaAYArGpEAwAwRTMCYFghkgmIIxKRDMAMEUjEmBYAalwnCjWVEyDIIFKBUGwRQlwyBYgFJhEExRMgyCBSgVBsEUJcMgWIBSYRBMUTIMggUoFQbBFCXDIFiAUmEQTFEyDIIFKBUGwRQlwyBYAG40KxiTAsEMEEzBmBQIZoBgCsakQDADBFMwJgWCGSCYgjEpEMwAwRSMSYFgBgimYEwKBDNAMAVjUhwg2L8taXt2k1Jh0jeaW4Qp1ZmSYbiCBSgVhv+SQ1EyDIIFKBUGwRQlwyBYgFJhEExRMgyCBSgVBsEUJcMgWIBSYRBMUTIMggUoFQbBFCXDIFiAUmEQTFEyDIIF4EazgjEpEMwAwRSMSYFgBgimYEwKBDNAMAVjUiCYAYIpGJMCwQwQTMGYFAhmgGAKxqRAMAMEUzAmBYIZlArDjWZFyTAIFqBUGARTlAyDYAFKhUEwRckwCBagVBgEU5QMg2ABSoVBMEXJMAgWoFQYBFOUDINgAUqFQTBFyTAIFqBUGARTlAyDYAG40axgTAoEM0AwBWNSIJgBgikYkwLBDBBMwZgUCGaAYArGpEAwAwRTMCYFghkgmIIxKRDMAMEUjEmBYAalwnCjWVEyDIIFKBUGwRQlwyBYgFJhEExRMgyCBSgVBsEUJcMgWIBSYRBMUTIMggUoFQbBFCXDIFiAUmEQTFEyDIIFKBUGwRQlwyBYAG40KxiTAsEMEEzBmBQIZoBgCsakQDADBFMwJgWCGSCYgjEpEMwAwRSMSYFgBgimYEwKBDNAMAVjUiCYQakw3GhWlAxjCHb7ervdECwJgimuHCYu2Jdat4dnCJYAwRRXDhMW7HafCnabXspaMGRpmqoCacFoaQHe/IjY7wrG92lFujPJukVL55TqTMkwCBag1OQQTFEyDIIFKDU5BFOUDOMJ1u9VRARTIJiiZBhDsCVNAyLYyJE3mpMdRbAUCGaAYIqSe3ofCGbshtNPDsEMSoZBsAAIpii5p/eBYMZuOP3kEMygZBgEC4BgipJ7eh8IZuyG008OwQxKhkGwAAimKLmn94Fgxm644uS40awoGQbBApSaHIIpSoZBsAClJodgipJhECxAqckhmKJkGAQLUGpyCKYoGQbBApSaHIIpSoZBsAClJodgipJhECxAqckhmKJkGAQLwI1mRck9vQ8EM3bD6SeHYAYlwyBYAARTlNzT+0AwYzecfnIIZlAyDIIFQDBFyT29j66CDVvWNQ2IYCMIZlAyzJZgb/52ctOACDaCYAYlw0SuYIKmARFsBMEMSobZFmyTpgERTMGNZkXJMG8E40fEL0pNDsEUJcNsC8aPiCOlJodgipJhECxAqckhmKJkGAQLUGpyCKYoGeaNYPwO9kWpySGYomSYbcE2aRoQwRQIpigZBsEClJocgilKhtkWjB8RR7jRrCi5p/fR/wqmrmpNAyLYCIIZlAwTkYkr2CFnQTDF6ce0AoIZIJii5J7exwd+B1v3C8FMEExx+jGtwKuIBgimKLmn94Fgxm44/eQQzKBkmDeC8SPiFwimKLmn98GfDDB2wxUnx41mRckwCBag1OQQTFEyDIIFKDU5BFOUDLMtGL+DjZSaHIIpSoZ5I9gWTQMimALBFCXDIFiAUpNDMEXJMG8EGzak+7cl6W3UIkzbp2rSX7CNMKU6UzLMtmC8yDFS6lsjVzBFyTAIFoAbzYqSe3ofvIpo7IbTTw7BDEqGeSPYFk0DItgIghmUDINgARBMUXJP7wPBjN1w+skhmEHJMAgWAMEUJff0PhDM2A2nnxyCGZQMg2ABEExRck/vA8GM3XDFyXGjWVEyDIIFaDG5IU22M8m6f9JBk51Jg2AG1xcsvd871+UXTHYmDYIZIJh8hp3rECwFghkgWKou2Zk0CGaAYPIZdq5DsBQIZoBgqbpkZ9IgmAGCyWfYuQ7BUiCYwecE+/v39Rk+P+t1ozlbl+xMGgQzQLARBDNAMAMEG0EwAwQzQLARBDNAMAMEG0EwAwQzQLARBDNAMAMEG0EwAwQzQLARBDNAMAMEk8+wcx2CpUAwAwRL1SU7kwbBDBBMPsPOdQiWAsEMECxVl+xMGgQzQDD5DDvXIVgKBDNAsFRdsjNpEMwAweQz7FyHYCkQzADBUnXJzqRBMAMEG+FGswGCGSDYCIIZIJgBgo0gmAGCGSDYCIIZIJgBgo0gmAGCGSDYCIIZIJgBgo0gmAGCGSDYCIIZIJgBgsln2LkOwVIgmAGCpeqSnUmDYAYIJp9h5zoES4FgBgiWqkt2Jg2CGSCYfIad6xAsBYIZIFiqLtmZNAhmgGDyGXauQ7AUScFu/wPBciBYrDNpLiEYV7A03GiOdSbNBQR7XsCmV7ImpKfaNNWB/AcE+3SLK/JOsPvkItb0OwBXsJFTC5bsTJoLXMF+JEOwBAgW60yaCwjGFWwHCBbrTJoLCHaf/urVNCCCjSCYwRUEm9I0IIKNIJgBghkg2AiCGSCYAYLJZ9i5DsFSIJgBgqXqkp1Jg2AGCCafYec6BEuBYAYIlqpLdiYNghkgmHyGnesQLAWCGSBYqi7ZmTQIZoBg8hl2rkOwFAhmgGCpumRn0iCYAYKNcKPZAMEMEGwEwQwQzADBRhDMAMEMEGwEwQwQzADBRhDMAMEMEGwEwQwQzADBRhDMAMEMEGwEwQwQzADB5DPsXIdgKRDMAMFSdcnOpEEwAwSTz7BzHYKlQDADBEvVJTuTBsEMEEw+w851CJYCwQwQLFWX7EwaBDNAMPkMO9chWAoEM0CwVF2yM2kQzADBRrjRbIBgBgg2gmAGCGaAYCMIZoBgBgg2gmAGCGaAYCMIZoBgBgg2gmAGCGaAYCMIZoBgBgg2gmAGCGaAYPIZdq5DsBQIZoBgqbpkZ9IgmEF3wYbeJJ8ggkkQzKC/YNkFO9edaMFw7xEMwfSCnetOtGC49wiGYHrBznUnWjDcewRDML1g57oTLRjuPYIhmF6wc92JFgz3HsEQTC/YtI4bzQYIZoBgIwhmgGAGCDaCYAYIZoBgIwhmgGAGCDaCYAZXE+zflqSn2n3BpnWnFuzI/RCh7Y40+QnDFWzvgk3rTi1YuPdcwRBML9i0DsEMEMwAwc6/YLj3CIZgesHOdSdaMNx7BEMwvWDnuhMtGO49giGYXrBz3YkWDPcewRBML9i57kQLhnuPYAimF+xcd6IFw71HMATTC3auO9GC4d4j2IkE6/1HaM6z37svGB72QXs6PfoWYS4rWLKu+77lRvPRW6bmn/pDsJ2FCCbrwsNGMAT7UB2C9dgzLcIg2EGFCCbrwsNGMAT7UB2C9dgzLcIg2EGFCCbrwsNGMAT7UB2C9dgzLcIg2EGFCCbrwsNGMAQrU3eiBcPDRjAEK1N3ogXDw0YwBCtTd6IFw8NGMAQrU3eiBcPDRjAEK1N3ogXDw0YwBCtTd6IFw8NGMAQrU3eiBcPDRjAEK1N3ogXDw0YwBPtQHTeae+yZFmEQ7KBCBJN14WEjGIJ9qA7BeuyZFmEQ7KBCBJN1h/yJjB57ZnYWBNtuVrIOwQ4vbH/lO2rPzM6CYNvNStYh2OGFCDZ+RLB9hQh2eF33PTM7C4JtNytZh2CHFyLY+BHB9hVePiiCpUCwgwovHxTBUiDYQYWXD4pgKRDsoMLLB0WwFAh2UOHlgyJYCgQ7qPDyQREsBYIdVHj5oAiWAsEOKrx8UARLgWAHFXKj+fC67ntmdhYE225Wsg7BDi9EsPEjgu0rRLDD67rvmdlZEGy7Wck6BDu8EMHGjwi2rxDBDq/rvmdmZ0Gw7WYl6xDs8EIEGz96gt1uNwTrWIdgPfbM7CwfFez2eEOwTnUI1mPPzM5SQ7Db9FK2RfovnwBUJ2RATrAvhLrHfAdQZ/c4+LvRPgijuHIYBAtAGAVhFAhmQBgFYRTVX0Us2ax9EEZx5TCmYFOaBizZrH0QRnHlMAgWgDAKwigQzIAwCsIoEMzgc2H+/n156DfMnz99w6zAmBQIZoBgCsakQDADBFMwJgWCGSCYgjEpEMwAwRSMSYFgBgimYEwKBDNAMAVjUiCYAYIpGJPiAMGaEvtfm3WCMArCKEQYBFuDMArCKBDMgDAKwigQzIAwCsIoqgsGcEUQDKAhCAbQEAQDaAiCATSkiGDRP2vaOMPtJ8n0/Uey3NeSfCjPY+kKzVE9+WyYrc7UEGz21+E+GeKRZPr+I1Fua0k+lOf2++edPx1G9eSDYd51BsGeGW7r2/oTUe6FBPsOU6w5JTrzvfSbziDYPEOJsT2/M9bIQ5gdYRBsSo2x3etto3uVMLd7oc7cnh8RLJqhwNgeYerkKRRG/MJTOEwNwaq8irj6/iNZKuWpE+amXrKrG6aIYADXBMEAGoJgAA1BMICGIBhAQxDs0yz+/7V/BzK8vF9Wbp82eCA0hd4XYFj9/KHWsDxitWzzawz5c9D7AvyoNEzfPa9dj8+fH76PuP98+nv48jSr55yWQHvocwGeF6lhrtL3wwvBft5+P/x+4f5SvDzn7F/QHtpcgIVg9/vckRftlte0ReFcsI1joT20ugBLwb5f9JhehDYFmx6+1G14PWh4Pg7toc8F2P4R8a1gk5OsXKOG5UHz46EttLkAr4LNr2D3YV2wFR/5HawYtLkADxu+f5z71mDxa9T8B8enN/NXEe/3l39Nz/m4Fk5KoD30+T8F4+4NHf9Pwbh7Q8cBGoJgAA1BMICGIBhAQxAMoCEIBtAQBANoCIIBNOT/AZ5fa3XDMpTeAAAAAElFTkSuQmCC" alt="plot of chunk histogram"/> </p>

<h2>Mean and median of the total number of steps taken per day</h2>

<pre><code class="r">mean_step = round(mean(dailysteps$total_steps))
median_step = median(dailysteps$total_steps)
</code></pre>

<p>the <strong>mean</strong> (red line on histogram) is <strong>9 354</strong> and the <strong>median</strong> (green line on histogram) is <strong>10 395</strong>. </p>

<h2>What is the average daily activity pattern?</h2>

<pre><code class="r">## average number of steps by interval
average_steps &lt;- ddply(activity, .(interval), summarise, 
                  mean_steps = mean(steps, na.rm = TRUE))
</code></pre>

<pre><code class="r">## the maximum number of steps
max_steps = max(average_steps$mean_steps)
cross_interval = average_steps[average_steps$mean_steps == max_steps,]$interval
</code></pre>

<pre><code class="r">## Time series plot
series_plot &lt;- ggplot( average_steps, aes(x=interval, y=mean_steps)) + 
                geom_line(colour = &quot;red&quot;) +                                
                geom_vline(xintercept = cross_interval, colour=&quot;blue&quot;, linetype = &quot;longdash&quot;) + 
                xlab(&quot;Time interval&quot;) +
                ylab(&quot;Average steps&quot;)+
                ggtitle(&quot;Average steps by time interval of a day&quot;)
series_plot
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk time_series_plot"/> </p>

<h3>Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?</h3>

<pre><code class="r">## the maximum number of steps
max_steps = max(average_steps$mean_steps)
## the average cross interval
cross_interval = average_steps[average_steps$mean_steps == max_steps,]$interval
</code></pre>

<p>the average across interval (the blue line on the time series plot) is <strong>835</strong> for <strong>206</strong> maximum number of steps</p>

<h2>Imputing missing values</h2>

<pre><code class="r">## the total number of missing values in the dataset
total_na &lt;- nrow(activity[is.na(activity$steps),])
</code></pre>

<p>there is <strong>2304</strong>  missing values in the data set.</p>

<h3>Filling the missing values in the data set</h3>

<pre><code class="r">## calculate the mean steps for each interval
mean_interval_steps &lt;- ddply(activity, .(interval), summarise, 
                    mean_steps = mean(steps, na.rm = TRUE))

## merge activity and interval mean steps
m &lt;- join(x = activity, y = mean_interval_steps, by = &quot;interval&quot;)
m[is.na(m$steps),]$steps = m[is.na(m$steps),]$mean_steps

activity2 &lt;- m[, c(1:3)]
</code></pre>

<pre><code class="r">## total number of steps taken by day
dailysteps2 &lt;- ddply(activity2, .(date), summarise, 
                    total_steps = sum(steps))

## Mean and median of the total number of steps taken per day
mean_step2 = round(mean(dailysteps2$total_steps))
median_step2 = round(median(dailysteps2$total_steps))

ve2 &lt;- c(mean_step2, median_step2)
df2 &lt;- data.frame(ve2)

## histogram of the total number of steps taken each day
histo2 &lt;- ggplot(dailysteps2, aes(x= total_steps)) +
  geom_histogram(fill=&quot;lightblue&quot;, colour=&quot;black&quot;, binwidth=2000) +  
  geom_vline(aes(xintercept = mean_step2), color=&quot;red&quot;, linetype=&quot;dashed&quot;, size=1) +          
  geom_vline(aes(xintercept = median_step2), color=&quot;blue&quot;, linetype=&quot;dashed&quot;, size=1) +
  xlab(&quot;Total Number of steps&quot;) +
  ggtitle(&quot;The total number of steps taken each day&quot;)
histo2
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA2AAAAGwCAMAAAD47faQAAAAFVBMVEUAAAAAAP9/f3+t2Obl5eXy8vL///+plGp+AAAACXBIWXMAAAsSAAALEgHS3X78AAATqUlEQVR4nO2djVbbShIGjXbj93/kXcAY+aflTy2PXVGqzgkQ4pFq21MIrGzu4Sgiwzi8W0BkzxiYyEAMTGQgBiYyEAMTGYiBiQzEwEQGYmAiAzEwkYEYmMhADExkIAYmMhADExmIgYkMxMBEBmJgIgMxMJGBGJjIQAysz+Gb+0M8BB8Xhw1OvOLx607+UMYNsw7ntYnD7O29P1n+eOmY+QMMjIzz2sRPYIfvi8rh8HNxOV3abt7+DPxnyeF0lM/fnz91ebTD8d5BT7+/Ofrv2jtrzme7evTc/XBxhOuHfB1ift12Ay3jfDZx2mSnzXv4/dTxsp7Lj+8sOfz8uv9HvyebfUd6uHP068/dFbl+9M3BZw+9PtLvQwwswflsYrbJHgR2vPy42M/Xn7pefRPYvTPN19yc/N6j5wcvPKuHuH8e4IA2cRXYYfbt2/F6u1+8IJIEdv0Sym1x5+vLxWMP5z+aKZ7++HC89+jZ5wrPy49/H+L+eYAD2sSdK9jsT26uFOuvYMfZUYvTzPf5TQ9XJz88enTleX2k0y+3zyOc0CbywK4e89rArs6yFFjhec/ZwAKc0CbuBFbv62PxLeL8263vy8zd0O6Wd53v9eduT3595GWhm/9Js4cYWIAT2sRlYLNX0OcvoZ8/vndlmH36vKevX6Y//h7z4hOXRz9t+auX6W9Pfrg80OHy4PPX4u88ZO7s7glwRLvixU+nu+chjmhXGBgNR7QrXvp0Htw8j1kzo//e50/x+XVUR1/Hc1z4Mh8fa4/yr0xmPU+WiQObpun77WRgPQysYs8yaWDT969p9qmhgshhbcPAKvYsE1/BvgI7X8DmVzJ5Ox8f7zaQjKXApvN17JuhXwGQX4224RWsYs8yeWDT1XsDW4mBVexZJg5s+nljYE0MrGLPMmlg0/dPXfMfvYYKIoe1DQOr2LNMfAW7ZaggcljbUKZizzIGFqBMhTIVBrYCZSqUqTCwFShToUyFga1AmQplKgxsBcpUKFNhYCtQpkKZCgNbgTIVylQY2ApQMoc7fHzc++wVI2RQk0HKGFgASubwn1s+Pu588goDyzCwFezxmTOwCqSMgQWgZAysAiljYAEoGQOrQMoYWABKxsAqkDIGFoCSMbAKpIyBBaBkDKwCKWNgASiZe4ElGFiGga1gj8+cgVUgZQwsACVjYBVIGQMLQMkYWAVSxsACUDIGVoGUMbAAlIyBVSBlDCwAJWNgFUgZAwtAyRhYBVLGwAJQMt5orkDKGFgASsbAKpAyBhaAkjGwCqSMgQWgZAysAiljYAEoGQOrQMpsCOzPSMYefSUomXZgI2RQk0HKeAULQMl4BatAyhhYAErGwCqQMgYWgJLxRnMFUsbAAlAyBlaBlDGwAJSMgVUgZQwsACVjYBVIGQMLQMkYWAVSxsACUDIGVoGUMbAAlIyBVSBlDCwAJWNgFUgZAwtAyXijuQIpY2ABKBkDq0DKGFgASsbAKpAyBhaAkjGwCqSMgQWgZAysAiljYAEoGQOrQMoYWABKxsAqkDIGFoCSMbAKpIyBBaBkvNFcgZQxsACUjIFVIGUMLAAlY2AVSBkDC0DJGFgFUsbAAlAyBlaBlDGwAJSMgVUgZQwsACVjYBVIGQMLQMkYWAVSxsACUDLeaK5AyhhYAErGwCqQMgYWgJIxsAqkjIEFoGQMrAIpY2ABKBkDq0DKxIFN03R+a2AdDKxizzJpYF91nd4aWAsDq9izTHwFuwxsml/K5JW0A3u3uByXA5uOXsG24I3mij3L5IFNRwPbhIFV7FkmDmyaR2ZgDQysYs8yaWDT909dvorYx8Aq9iwTX8FuGSqIHNY2DKxizzIGFoCSMbAKpIyBBaBkDKwCKWNgASgZA6tAyhhYAErGv8lRgZQxsACUjIFVIGUMLAAlY2AVSBkDC0DJGFgFUsbAAlAyBlaBlDGwAJSMgVUgZQwsACVjYBVIGQMLQMkYWAVSxsACUDLeaK5AyhhYAErGwCqQMgYWgJIxsAqkjIEFoGQMrAIpY2ABKBkDq0DKGFgASsbAKpAyBhaAkjGwCqSMgQWgZAysAiljYAEoGW80VyBlDCwAJWNgFUgZAwtAyRhYBVLGwAJQMgZWgZQxsACUjIFVIGUMLAAlY2AVSBkDC0DJGFgFUsbAAlAyBlaBlDGwAJSMN5orkDIbAvszkrFHXwlKph3YCBnUZJAyXsECUDJewSqQMgYWgJIxsAqkjIEFoGQMrAIpY2ABKBkDq0DKGFgASsbAKpAyBhaAkjGwCqSMgQWgZLzRXIGUMbAAlIyBVSBlDCwAJWNgFUgZAwtAyRhYBVLGwAJQMgZWgZQxsACUjIFVIGUMLAAlY2AVSBkDC0DJGFgFUsbAAlAy3miuQMoYWABKxsAqkDIGFoCSMbAKpIyBBaBkDKwCKWNgASgZA6tAyhhYAErGwCqQMgYWgJIxsAqkjIEFoGQMrAIpY2ABKBlvNFcgZQwsACVjYBVIGQMLQMkYWAVSxsACUDIGVoGUMbAAlIyBVSBlDCwAJWNgFUgZAwtAyRhYBVLGwAJQMgZWgZQxsACUjDeaK5AyKwKbPn/9HwPrYWAVe5bJA/sqa5p9YqggcljbMLCKPcvEgU2fcZ0vYPMrmbyUdmDvFpfjw28RLy5iQ78CIL8abcMrWMWeZdYFNntnYGsxsIo9y3gFC0DJGFgFUmblFWz+o9dQQeSwtmFgFXuWWRHYNUMFkcPahjeaK/YsY2ABKBkDq0DKGFgASsbAKpAyBhaAkjGwCqSMgQWgZAysAiljYAEoGQOrQMoYWABKxsAqkDIGFoCSMbAKpIyBBaBkvNFcgZQxsACUjIFVIGUMLAAlY2AVSBkDC0DJGFgFUsbAAlAyBlaBlDGwAJSMgVUgZQwsACVjYBVIGQMLQMkYWAVSxsACUDLeaK5AyhhYAErGwCqQMgYWgJIxsAqkjIEFoGQMrAIpY2ABKBkDq0DKLAd2WKpuqCByWNswsIo9yywFdvjBwJ6BgVXsWSa5ghUMFUQOaxsGVrFnmeXAFhkqiBzWNrzRXLFnmQeB+S3iJygZA6tAyiwH5reIX6BkDKwCKWNgASgZA6tAyhhYAErGwCqQMg8CW/oZ7M9Ixh59JSiZdmAjZFCTQcosB7bI0K8AyK9G2/AKVrFnGQMLQMkYWAVSZjkw/ybHFygZbzRXIGWCK1h1VRsqiBzWNgysYs8ySUxewZ5yFAOr2LOMgQWgZAysAimz3NLSj2AGthIDq9izTHaxMrAnYGAVe5YxsACUjIFVIGUeBOa3iJ+gZAysAimzHJj/ZMAXKBlvNFcgZQwsACVjYBVIGQMLQMkYWAVSZjkwfwb7AiVjYBVImQeBLTFUEDmsbRhYxZ5lDCwAJWNgFUiZB4EdFqIbKogc1jYMrGLPMsuB+SLHFygZA6tAyhhYAErGG80VSJnlwHwV8QuUjIFVIGUeBLbEUEHksLZhYBV7ljGwAJSMgVUgZQwsACVjYBVIGQMLQMkYWAVSxsACUDIGVoGUMbAAlIyBVSBlDCwAJeON5gqkjIEFoGQMrAIpY2ABKBkDq0DKGFgASsbAKpAyBhaAkjGwCqTMisCmz1/TZGBNDKxizzJ5YJ9pTafODKyBgVXsWSYObDrOA5vmlzJ5Je3A2rz7f/GeePAtolewDbz7RnMzzKtL3yWoySBlDCwAJWNgFUgZAwtAyRhYBVJmXWC+irgBA6vY49PkfbAVoGQMrAIpY2ABKBkDq0DKGFgASsbAKpAyBhaAkjGwCqSMgQWgZNo3mg0swsBWsMdnzsAqkDIGFoCSMbAKpIyBBaBkDKwCKWNgASgZA6tAyhhYAErGwCqQMgYWgJIxsAqkjIEFoGQMrAIpY2ABKBlvNFcgZQwsACVjYBVIGQMLQMkYWAVSxsACUDIGVoGUMbAAlIyBVSBlDCwAJWNgFUgZAwtAyRhYBVLGwAJQMgZWgZQxsACUjDeaK5AyBhaAkjGwCqSMgQWgZAysAiljYAEoGQOrQMoYWABKxsAqkDIGFoCSMbAKpIyBBaBkDKwCKWNgASgZA6tAyhhYAErGG80VSJkNgf0ZydijrwQl8/rAFmRQk0HKeAULQMl4BatAyhhYAErGwCqQMgYWgJIxsAqkjIEFoGQMrAIpY2ABKBkDq0DKGFgASsbAKpAyBhYwQubQpttJO7Auzcm0Qe4ZAwsYElh7v794Xf+Ezcm0Qe4ZAwswsNa65mTaIPeMgQUYWGtdczJtkHvGwAIMrLWuOZk2yD1jYAEG1lrXnEwb5J4xsAADa61rTqYNcs8YWICBtdY1J9MGuWcMLAAf2Ngbzd11zcm0Qe4ZAwswsNa65mTaIPeMgQUYWGtdczJtkHvGwAIMrLWuOZk2yD1jYAEG1lrXnEwb5J4xsAADa61rTqYNcs8YWICBtdY1J9MGuWcMLMDAWuuak2mD3DMGFoAPbOQ6A2thYCswsNa65mTaIPeMgQUYWGtdczJtkHvGwAIMrLWuOZk2yD1jYAEG1lrXnEwb5J4xsAADa61rTqYNcs8YWICBtdY1J9MGuWcMLMDAWuuak2mD3DMGFoAPzBvNnyD3zMrApv9jYD0MLJtMG+SeWRuYV7A2BpZNpg1yz6wL7HwBm1/JpMM/ENi7R0zkUWDH2UVs6FcA5FejbXgFyybTBrln1gX2E5mBNTCwbDJtkHvGK1iAgbXWNSfTBrlnVl7B5j96DRVEDmsbBpZNpg1yz6wMbM5QQeSwtuGN5mwybZB7xsACDKy1rjmZNsg9Y2ABBtZa15xMG+SeMbAAA2uta06mDXLPGFiAgbXWNSfTBrlnDCzAwFrrmpNpg9wzBhZgYK11zcm0Qe4ZAwswsNa65mTaIPeMgQXgA/NG8yfIPWNgAQbWWtecTBvknjGwAANrrWtOpg1yzxhYgIG11jUn0wa5ZwwswMBa65qTaYPcMwYWYGCtdc3JtEHuGQMLMLDWuuZk2iD3jIEFGFhrXXMybZB7xsAC8IGNXGdgLQxsBQbWWtecTBvknjGwAANrrWtOpg1yzxhYgIG11jUn0wa5ZwwswMBa65qTaYPcMwYWYGCtdc3JtEHuGQMLMLDWuuZk2iD3jIGdOLyal+/3l59wxNO0hIE1/LaxJrBXb7/mOm80lxhYw28bBjbohNG6EU/TEgbW8NuGgQ06YbRuxNO0hIE1/LZhYINOGK0b8TQtYWANv20Y2KATRutGPE1LGFjDbxsGNuiE0boRT9MSewvsz0jGHv0OBvbshYdXP4Uv3zNL/Mh4BTthYM9e6BXs672BffNXB8Y84YinaQkDa/htw8DeecIRT9MSBtbw24aBvfOEI56mJQys4bcNA3vnCUc8TUsY2Ape/ndvDezpJ4yf7Cft6fZTP0IGH9iLd8PL9+1fI/oXBfYUUQNbHlZznYE9/4Txk21gBoZZ9xedMH6yDczAMOu80fz8PTNCxsCetBAhamCb9swIGQN70kKEqIFt2jMjZAzsSQsRoga2ac+MkDGwJy1EiBrYpj0zQsbAnrQQIWpgm/bMCBkDe9JChKiBbdozI2QM7EkLEaIGtmnPjJAxsCct3L2ogbUwsCct3L2ogbUwsCct3L1o/4RP+cvtr9gzF0cxsOVhNdcZGOaEBmZgb1y3/xMamIG9cd3+T2hgBvbGdfs/oYEZ2BvX7f+EBmZgb1z3F91o7q57+Z65OIqBLQ+ruc7Anr7QwL7eG9i2hQhRA9u0Zy6OYmDLw2quM7CnLzSwr/cGtm0hQtTANu2Zi6MY2PKwmusM7OkLDezr/brApmkysLeuM7Dn75mLo7w1sOn0y8Dets7Anr9nLo7CCGyaX8qWaP+VahE6UQG9wD4p0v1L/+sqSyhToUwF/VtE5LC2oUzFnmUMLECZCmUq6K8iIoe1DWUq9iyzMrA5QwWRw9qGMhV7ljGwAGUqlKkwsBUoU6FMhYGtAC/z8bH2KP/KZNZjYCvY8zM3x8A+QcoYWABexsA+QcoYWABexsA+QcoYWABexsA+QcoYWABexsA+QcoYWABexsA+QcoYWABexsA+QcpsCGwo2f/b7EUoU6FMRSFjYPdQpkKZCgNbgTIVylQY2AqUqVCmgh6YyB4xMJGBGJjIQAxMZCAGJjIQSGDpP2s62GH6MZm/fYvL8Z7Jm3xOpyYMp5rJe2WWJsMI7OJfh3unxMlk/vYtKtM9kzf5TL//vPO7ZaqZvFHm0WQM7Oww3d/W71A5ggL7loENBzGZ71M/mIyBXTognrbzV0aGjzIbZAxsDuNpO/K20ZEiMx1Bk5nO7w0sdQA8bScZjg9IpviBByzDCIzyKuLdt29xIflwZKbqJTuuDCQwkX1iYCIDMTCRgRiYyEAMTGQgBvZurv772r9PyOHm7fXK5cOGD5ShOHsAh7sfn9I6XD/i7rLFP/NJfh/OHsBPSof5m/O16/Tx+d33I44/H/4+/Powd485XyLjcc4Azhepw2VK35++Cuzn1++73z843iy+PubF72Q8jhnAVWDH42UjN9ldX9OuFl4GtvBYGY+jBnAd2PeLHvOL0GJg84df53a4fdDh/HkZj3MGsPwt4sPAZge5c406XD/o8vEyFscM4DawyyvY8XA/sDs9+jMYDMcM4FTD97dz3xlc/Rh1+Y3juZvLVxGPx5vfzY95uhbOlsh4nPM/hU/3q3Hi/xQ+3a/GiYsMxMBEBmJgIgMxMJGBGJjIQAxMZCAGJjIQAxMZyP8ALLiTXvfOVqgAAAAASUVORK5CYII=" alt="plot of chunk histogramm2"/> </p>

<h3>Mean and median</h3>

<pre><code class="r">## Mean and median of the total number of steps taken per day
mean_step2 = round(mean(dailysteps2$total_steps))
median_step2 = round(median(dailysteps2$total_steps))
</code></pre>

<p>the <strong>mean</strong> <code>10 766</code> and the <strong>median</strong>  <code>10 766</code> differs from the first estimated without empty values, they have the same value because of the filling of the NA values </p>

<h2>Are there differences in activity patterns between weekdays and weekends?</h2>

<h3>Create a new factor variable in the dataset with two levels &ldquo;weekday&rdquo; and &ldquo;weekend&rdquo;</h3>

<pre><code class="r">days&lt;- weekdays(as.Date(activity$date, ))
activity$day = days

weekend_flag = days==&quot;Sunday&quot; | days==&quot;Saturday&quot;

activity$type[weekend_flag] = &quot;weekend&quot;
activity$type[!weekend_flag] = &quot;weekday&quot;


activity$day = as.factor(activity$type)
activity &lt;- activity[, c(1:4)]
</code></pre>

<h3>Plot in a time series</h3>

<pre><code class="r">## average number of steps by interval
new_average_steps &lt;- ddply(activity, .(day, interval), summarise, 
                       mean_steps = mean(steps, na.rm = TRUE))

## Time series plot
series_plot2 &lt;- ggplot( new_average_steps, aes(x=interval, y=mean_steps)) + 
                  geom_line(colour = &quot;deepskyblue&quot;) +    
                  facet_wrap(~ day, ncol=1) +
                  theme_bw() +
                  theme(                  
                    panel.grid.major = element_blank(), 
                    panel.grid.minor = element_blank(), 
                    axis.line = element_line(colour = &quot;black&quot;)) +                                     
                  xlab(&quot;Interval&quot;) +
                  ylab(&quot;Number of steps&quot;)

series_plot2
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk time_series_plot2"/> </p>

</body>

</html>
